<!-- views/providersDashboard -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel='stylesheet', href='/stylesheets/style.css'>
  <title>provider dashboard</title>
 
</head>
  <body>
    <main>
      <div class="users_wrapper">

        <!--users top section -->
        <div id="users_top">
          <b>WELCOME TO PROVIDER DASHBOARD</b>
          <header><%- include ('partials/header.ejs') %></header>
        </div>

        <!-- users left section -->
        <div id="users_left">
          <a href="/providers/providerProfile">Profile</a><br><br>
          <a href="/">Report</a><br><br><br>
          <!-- Logout Link -->
          <a href="/providers/logout">Logout</a>

        </div>

        <!-- users container -->
        <div id="users_container">

          <!-- Users details -->
          <div>
            <h1>Welcome, <%= user.firstName %></h1>
            <b>Specialty: <%= user.specialty %></b>
          </div><br>

          <!-- Usera container header -->
          <div class="cHeader">
            <a href="/providers/appointments?status=pending" class="<%= status === 'pending' ? 'active' : '' %>">Pending Appointments</a>
            <a href="/providers/appointments?status=accepted" class="<%= status === 'accepted' ? 'active' : '' %>">Accepted Appointments</a>
            <a href="/providers/appointments?status=cancelled" class="<%= status === 'cancelled' ? 'active' : '' %>">Cancelled Appointments</a>
          </div>

          <!-- Dashboard Views -->
          <div class="dViews" id="dv">
              <a class="dViewsList">
                  <h3>Pending Appointments</h3>
                  <p>2222222</p>
              </a>
              <a class="dViewsList">
                  <h3>Patients Accepted</h3>
                  <p>1111111</p>
              </a>
              <a class="dViewsList">
                  <h3>Patients Cancelled</h3>
                  <p>555555555</p>
              </a>
              <a class="dViewsList">
                  <h3>Patients online</h3>
                  <p>999999999</p>
              </a>
          </div>

          <!-- Appointment status filter -->
          <div id="appointmentStatus">
              <h2><%= status.charAt(0).toUpperCase() + status.slice(1) %> Appointments</h2>
              <% if (appointments.length > 0) { %>
                  <table>
                      <thead>
                          <tr>
                              <th>Patient Name</th>
                              <th>Appointment Date</th>
                              <th>Appointment Time</th>
                              <th>Status</th>
                              <th>Actions</th>
                          </tr>
                      </thead>
                      <tbody>
                          <% appointments.forEach(appointment => { %>
                              <tr>
                                  <td><%= appointment.patient_first_name %> <%= appointment.patient_last_name %></td>
                                  <td><%= appointment.appointment_date %></td>
                                  <td><%= appointment.appointment_time %></td>
                                  <td><%= appointment.status %></td>
                                  <td class="action-links">
                                      <% if (appointment.status === 'pending') { %>
                                          <form action="/providers/respond" method="POST">
                                            <input type="hidden" name="appointmentId" value="<%= appointment.appointment_id %>">
                                            <button type="submit" name="action" value="accept">Accept</button>
                                            <button type="submit" name="action" value="cancel">Cancel</button>
                                          </form>
                                      <% } else if (appointment.status === 'accepted') { %>
                                          <form action="/providers/respond" method="POST">
                                            <input type="hidden" name="appointmentId" value="<%= appointment.appointment_id %>">
                                            <button><a href="/chat/<%= appointment.appointment_id %>">Chat</a></button>
                                            <button type="submit" name="action" value="cancel">Cancel</button>
                                          </form>
                                      <% } else if (appointment.status === 'cancelled') { %>
                                          <form action="/providers/respond" method="POST">
                                            <input type="hidden" name="appointmentId" value="<%= appointment.appointment_id %>">
                                            <button type="submit" name="action" value="accept">Re-Accept</button>
                                          </form>
                                      <% } %>
                                  </td>
                              </tr>
                          <% }); %>
                      </tbody>
                  </table>
              <% } else { %>
                  <p>No <%= status %> appointments found.</p>
              <% } %>
          </div>
        </div>

        <!-- users footer -->
        <div id="users_footer"><%- include ('partials/footer.ejs') %></div>
      </div>
    </main>

    
    <script src="/javascripts/main.js"></script>

  </body>
</html>